# ==================================================================
# WARNING: This file is auto-generated by generate_docker_compose
# Do not modify this file directly. Instead, update the .env.example
# or docker-compose-template.yaml and regenerate this file.
# ==================================================================

x-shared-env: &shared-api-worker-env
  NEXT_PUBLIC_DEPLOY_ENV: ${NEXT_PUBLIC_DEPLOY_ENV:-DEVELOPMENT}
  NEXT_PUBLIC_EDITION: ${NEXT_PUBLIC_EDITION:-SELF_HOSTED}
  NEXT_PUBLIC_API_PREFIX: ${NEXT_PUBLIC_API_PREFIX:-http://localhost:5001/console/api}
  NEXT_PUBLIC_WEB_PREFIX: ${NEXT_PUBLIC_WEB_PREFIX:-http://localhost:3000}
  NEXT_PUBLIC_PUBLIC_API_PREFIX: ${NEXT_PUBLIC_PUBLIC_API_PREFIX:-http://localhost:5001/api}
  NEXT_PUBLIC_PUBLIC_WEB_PREFIX: ${NEXT_PUBLIC_PUBLIC_WEB_PREFIX:-http://localhost:3000}
  NEXT_PUBLIC_MARKETPLACE_API_PREFIX: ${NEXT_PUBLIC_MARKETPLACE_API_PREFIX:-https://marketplace.dify.ai/api/v1}
  NEXT_PUBLIC_MARKETPLACE_URL_PREFIX: ${NEXT_PUBLIC_MARKETPLACE_URL_PREFIX:-https://marketplace.dify.ai}
  NEXT_PUBLIC_SENTRY_DSN: ${NEXT_PUBLIC_SENTRY_DSN:-}
  NEXT_TELEMETRY_DISABLED: ${NEXT_TELEMETRY_DISABLED:-1}
  NEXT_PUBLIC_UPLOAD_IMAGE_AS_ICON: ${NEXT_PUBLIC_UPLOAD_IMAGE_AS_ICON:-false}
  NEXT_PUBLIC_TEXT_GENERATION_TIMEOUT_MS: ${NEXT_PUBLIC_TEXT_GENERATION_TIMEOUT_MS:-60000}
  NEXT_PUBLIC_CSP_WHITELIST: ${NEXT_PUBLIC_CSP_WHITELIST:-}
  NEXT_PUBLIC_ALLOW_EMBED: ${NEXT_PUBLIC_ALLOW_EMBED:-}
  NEXT_PUBLIC_GITHUB_ACCESS_TOKEN: ${NEXT_PUBLIC_GITHUB_ACCESS_TOKEN:-}
  NEXT_PUBLIC_TOP_K_MAX_VALUE: ${NEXT_PUBLIC_TOP_K_MAX_VALUE:-100}
  NEXT_PUBLIC_INDEXING_MAX_SEGMENTATION_TOKENS_LENGTH: ${NEXT_PUBLIC_INDEXING_MAX_SEGMENTATION_TOKENS_LENGTH:-4000}
  NEXT_PUBLIC_LOOP_NODE_MAX_COUNT: ${NEXT_PUBLIC_LOOP_NODE_MAX_COUNT:-100}
  NEXT_PUBLIC_MAX_TOOLS_NUM: ${NEXT_PUBLIC_MAX_TOOLS_NUM:-10}
  NEXT_PUBLIC_MAX_PARALLEL_LIMIT: ${NEXT_PUBLIC_MAX_PARALLEL_LIMIT:-10}
  NEXT_PUBLIC_MAX_ITERATIONS_NUM: ${NEXT_PUBLIC_MAX_ITERATIONS_NUM:-5}
  NEXT_PUBLIC_ENABLE_WEBSITE_JINAREADER: ${NEXT_PUBLIC_ENABLE_WEBSITE_JINAREADER:-true}
  NEXT_PUBLIC_ENABLE_WEBSITE_FIRECRAWL: ${NEXT_PUBLIC_ENABLE_WEBSITE_FIRECRAWL:-true}
  NEXT_PUBLIC_ENABLE_WEBSITE_WATERCRAWL: ${NEXT_PUBLIC_ENABLE_WEBSITE_WATERCRAWL:-true}

services:
  # Frontend web application.
  web:
    image: mhmtmtlu/chatbot:1.4.0
    restart: always
    platform: linux/amd64
    environment:
      CONSOLE_API_URL: ${CONSOLE_API_URL:-}
      APP_API_URL: ${APP_API_URL:-}
      SENTRY_DSN: ${WEB_SENTRY_DSN:-}
      NEXT_TELEMETRY_DISABLED: ${NEXT_TELEMETRY_DISABLED:-0}
      TEXT_GENERATION_TIMEOUT_MS: ${TEXT_GENERATION_TIMEOUT_MS:-60000}
      CSP_WHITELIST: ${CSP_WHITELIST:-}
      ALLOW_EMBED: ${ALLOW_EMBED:-false}
      MARKETPLACE_API_URL: ${MARKETPLACE_API_URL:-https://marketplace.dify.ai}
      MARKETPLACE_URL: ${MARKETPLACE_URL:-https://marketplace.dify.ai}
      TOP_K_MAX_VALUE: ${TOP_K_MAX_VALUE:-}
      INDEXING_MAX_SEGMENTATION_TOKENS_LENGTH: ${INDEXING_MAX_SEGMENTATION_TOKENS_LENGTH:-}
      PM2_INSTANCES: ${PM2_INSTANCES:-2}
      LOOP_NODE_MAX_COUNT: ${LOOP_NODE_MAX_COUNT:-100}
      MAX_TOOLS_NUM: ${MAX_TOOLS_NUM:-10}
      MAX_PARALLEL_LIMIT: ${MAX_PARALLEL_LIMIT:-10}
      MAX_ITERATIONS_NUM: ${MAX_ITERATIONS_NUM:-5}
      ENABLE_WEBSITE_JINAREADER: ${ENABLE_WEBSITE_JINAREADER:-true}
      ENABLE_WEBSITE_FIRECRAWL: ${ENABLE_WEBSITE_FIRECRAWL:-true}
      ENABLE_WEBSITE_WATERCRAWL: ${ENABLE_WEBSITE_WATERCRAWL:-true}
